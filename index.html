<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lumina AI ‚Äî Ultra Maxx (POC)</title>
  <meta name="description" content="Lumina AI frontend POC ‚Äî TradingView chart, assistant, demo/real toggle, lot controls" />
  <!-- TradingView widget -->
  <script src="https://s3.tradingview.com/tv.js"></script>
  <style>
    :root{
      --bg-dark:#071023;
      --panel-dark:#071428;
      --muted:#9fb0c8;
      --accent:#ff6ea8;
      --green:#39d353;
      --red:#ff4d4f;
      --glass: rgba(255,255,255,0.03);
      --card: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
    }
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Roboto,Arial;color:#e6f0fb;background:var(--bg-dark)}
    .app { max-width:1200px;margin:0 auto;padding:10px;box-sizing:border-box; }
    header.top {
      display:flex;align-items:center;gap:12px;padding:10px 6px;
    }
    .brand { font-weight:700;color:var(--accent);display:flex;align-items:center;gap:8px;font-size:20px }
    .left-controls { display:flex; gap:8px; align-items:center; flex:1; flex-wrap:wrap }
    .control { background:var(--panel-dark); border-radius:8px; padding:6px 8px; border:1px solid var(--glass;); }
    .control input, .control select { background:transparent;border:none;color:inherit;outline:none }
    .lot-control { display:flex; align-items:center; gap:6px; background:transparent; }
    button, select, input { font-size:14px }
    .btn { padding:8px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.04); background:transparent;color:inherit; cursor:pointer }
    .btn.primary { background:var(--green); color:#001; border:none }
    .btn.danger { background:var(--red); color:#fff; border:none }
    .btn.gold { background:#8b6f12;color:#fff }
    #chart-wrap{ height:46vh; border-radius:10px; overflow:hidden; margin:12px 0; background: #050914; border:1px solid rgba(255,255,255,0.03) }
    .controls-row { display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin:6px 0 }
    .panel { background:var(--panel-dark); padding:10px;border-radius:10px; border:1px solid rgba(255,255,255,0.02) }
    .signals { margin-top:12px; max-height:34vh; overflow:auto; border-radius:8px; padding:8px; }
    .signal-item { display:flex; justify-content:space-between; padding:8px; border-bottom:1px solid rgba(255,255,255,0.02) }
    .small { font-size:13px; color:var(--muted) }
    /* assistant slide panel */
    #luminaToggle { position:fixed; right:14px; bottom:14px; width:56px; height:56px; border-radius:12px; background:linear-gradient(90deg,#ff758c,#7c5cff); display:flex; align-items:center; justify-content:center; color:white; font-weight:700; z-index:1400; cursor:pointer; box-shadow:0 6px 22px rgba(0,0,0,0.4) }
    #luminaPanel { position:fixed; right:0; top:0; height:100%; width:420px; max-width:95%; background:var(--panel-dark); transform:translateX(110%); transition:transform .28s ease-in-out; z-index:1399; box-shadow:-24px 0 60px rgba(0,0,0,0.6); display:flex; flex-direction:column }
    #luminaPanel.open { transform:translateX(0) }
    .lumina-header { display:flex; align-items:center; justify-content:space-between; padding:12px; border-bottom:1px solid rgba(255,255,255,0.03) }
    .lumina-body { padding:12px; overflow:auto; flex:1 }
    .lumina-chat { max-height:60vh; overflow:auto; display:flex; flex-direction:column; gap:8px }
    .userMsg { align-self:flex-end; background:#0e2b3b; padding:8px; border-radius:8px; max-width:90% }
    .aiMsg { align-self:flex-start; background:linear-gradient(90deg,#ff758c,#7c5cff); color:#001; padding:8px;border-radius:8px; max-width:90% }
    .lumina-input-row { display:flex; gap:8px; align-items:center; padding:12px; border-top:1px solid rgba(255,255,255,0.02) }
    .icon-btn { background:transparent;border:none;color:inherit;padding:8px;border-radius:8px; cursor:pointer }
    /* responsive */
    @media(max-width:900px){
      #luminaPanel { width:100%; }
      #chart-wrap { height:42vh }
    }
    /* LIGHT theme switch */
    body.light { background:#f6f7fb; color:#0b1220 }
    body.light .panel, body.light #luminaPanel { background:#ffffff; color:#0b1220 }
    body.light .aiMsg { background:#ffd6ec; color:#071023 }
    .hidden { display:none }
  </style>
</head>
<body>
  <div class="app">

    <!-- TOP BAR -->
    <header class="top">
      <div class="brand">üíé Lumina AI</div>

      <div class="left-controls">
        <div class="control lot-control" title="Decrease lot">
          <button id="lotDec" class="btn">-</button>
          <input id="lotVal" value="0.01" style="width:72px;text-align:center;background:transparent;border:none;color:inherit" />
          <button id="lotInc" class="btn">+</button>
        </div>

        <div class="control">
          <select id="pairSelect" aria-label="pairs">
            <option value="EURUSD">EUR/USD</option>
            <option value="GBPUSD">GBP/USD</option>
            <option value="USDJPY">USD/JPY</option>
            <option value="XAUUSD">XAU/USD</option>
          </select>
        </div>

        <div class="control">
          <select id="tfSelect">
            <option value="60">1m</option>
            <option value="300">5m</option>
            <option value="900">15m</option>
            <option value="3600">1h</option>
            <option value="86400">1d</option>
          </select>
        </div>

        <div class="control" style="display:flex;gap:8px;align-items:center">
          <label class="small" style="margin-right:6px">Account</label>
          <button id="demoBtn" class="btn">DEMO</button>
          <button id="realBtn" class="btn">REAL</button>
        </div>
      </div>

      <div style="display:flex;gap:8px;align-items:center">
        <button id="themeSwitch" class="btn">üåô Dark Mode</button>
      </div>
    </header>

    <!-- Chart -->
    <div id="chart-wrap" class="panel">
      <div id="tv_chart_container" style="height:100%;"></div>
    </div>

    <!-- Controls -->
    <div class="panel controls-row">
      <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
        <button id="buyBtn" class="btn primary">BUY</button>
        <button id="sellBtn" class="btn danger">SELL</button>
        <input id="slInput" placeholder="SL (price)" style="width:120px;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent" />
        <input id="tpInput" placeholder="TP (price)" style="width:120px;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent" />
        <button id="exitBtn" class="btn gold">EXIT ALL</button>
      </div>

      <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
        <label class="small">Mode</label>
        <select id="modeSelect" class="control">
          <option value="auto">AUTO</option>
          <option value="manual">MANUAL</option>
        </select>
        <select id="indicatorSelect" class="control">
          <option>RSI</option>
          <option>MACD</option>
          <option>VWAP</option>
        </select>
      </div>
    </div>

    <!-- Live Signals + History -->
    <div class="panel">
      <strong>Live Signals</strong>
      <div id="liveSignals" class="signals"></div>
      <div class="small" style="margin-top:8px">History</div>
      <div id="historyBox" class="small" style="max-height:120px;overflow:auto;margin-top:6px"></div>
    </div>

    <footer class="small" style="margin-top:12px">Lumina UI ‚Äî demo only. For live trading deploy secure bridge + EA. Keep secrets server-side.</footer>
  </div>

  <!-- Lumina assistant toggle -->
  <div id="luminaToggle" title="Open Lumina">‚ô•Ô∏é</div>

  <!-- Lumina slide panel -->
  <div id="luminaPanel" aria-hidden="true">
    <div class="lumina-header">
      <div><strong>Lumina ‚Äî Assistant</strong><div class="small">Mode: Friendly</div></div>
      <div style="display:flex;gap:8px;align-items:center">
        <button id="cameraBtn" class="icon-btn" title="Camera">üì∑</button>
        <button id="fileBtn" class="icon-btn" title="Upload">üìÅ</button>
        <button id="micBtn" class="icon-btn" title="Voice">üé§</button>
        <button id="closeLumina" class="icon-btn">‚úï</button>
      </div>
    </div>

    <div class="lumina-body">
      <div id="chatBox" class="lumina-chat"></div>
    </div>

    <div class="lumina-input-row">
      <input id="chatInput" placeholder="Ask Lumina..." style="flex:1;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit" />
      <button id="sendChat" class="btn">Ask</button>
    </div>
  </div>

<script>
  // ---------- Basic UI wiring ----------
  const luminaToggle = document.getElementById('luminaToggle');
  const luminaPanel = document.getElementById('luminaPanel');
  const closeLumina = document.getElementById('closeLumina');
  luminaToggle.addEventListener('click', ()=> luminaPanel.classList.toggle('open'));
  closeLumina.addEventListener('click', ()=> luminaPanel.classList.remove('open'));

  // Theme switch
  const themeBtn = document.getElementById('themeSwitch');
  themeBtn.addEventListener('click', ()=>{
    const isLight = document.body.classList.toggle('light');
    themeBtn.innerText = isLight ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
  });

  // Lot +/- controls
  const lotVal = document.getElementById('lotVal');
  document.getElementById('lotInc').addEventListener('click', ()=> {
    let v = parseFloat(lotVal.value || '0.01');
    v = +(v + 0.01).toFixed(2);
    lotVal.value = v;
  });
  document.getElementById('lotDec').addEventListener('click', ()=> {
    let v = parseFloat(lotVal.value || '0.01');
    v = Math.max(0.01, +(v - 0.01).toFixed(2));
    lotVal.value = v;
  });

  // Demo/Real toggle (frontend)
  document.getElementById('demoBtn').addEventListener('click', ()=> {
    alert('Switched to DEMO (frontend only). Balance: $50,000 demo.');
  });
  document.getElementById('realBtn').addEventListener('click', ()=> {
    alert('Switched to REAL (requires Bridge + EA). Connect Bridge to trade live.');
  });

  // Buy/Sell/Exit wiring (POC)
  const liveSignalsBox = document.getElementById('liveSignals');
  const historyBox = document.getElementById('historyBox');

  function addSignal(type, pair, entry, sl, tp, score) {
    const item = document.createElement('div');
    item.className = 'signal-item';
    const left = document.createElement('div');
    left.innerHTML = `<strong style="color:${type==='BUY'?'#39d353':'#ff4d4f'}">${type}</strong><div class="small">${pair} ‚Ä¢ ${Math.round((new Date()).getTime()/1000)}s</div><div class="small">Entry: ${entry} | SL: ${sl} | TP: ${tp}</div>`;
    const right = document.createElement('div');
    right.innerHTML = `<div style="text-align:right">${score}%</div><button class="btn" onclick="removeSignal(this)">Remove</button>`;
    item.appendChild(left);
    item.appendChild(right);
    liveSignalsBox.prepend(item);

    // history log
    const h = document.createElement('div');
    h.innerText = `${new Date().toLocaleString()} ‚Ä¢ ${pair} ‚Ä¢ ${type} ‚Ä¢ entry ${entry} ‚Ä¢ score ${score}%`;
    historyBox.prepend(h);
  }
  window.removeSignal = function(btn){
    const el = btn.closest('.signal-item');
    if(el) el.remove();
  };

  document.getElementById('buyBtn').addEventListener('click', ()=>{
    const pair = document.getElementById('pairSelect').value || 'EURUSD';
    addSignal('BUY', pair, '1.00000', '0.99900', '1.00200', 98);
    alert('Manual BUY queued (demo).');
  });
  document.getElementById('sellBtn').addEventListener('click', ()=>{
    const pair = document.getElementById('pairSelect').value || 'EURUSD';
    addSignal('SELL', pair, '1.00000', '1.00100', '0.99800', 95);
    alert('Manual SELL queued (demo).');
  });
  document.getElementById('exitBtn').addEventListener('click', ()=>{
    alert('Exit all triggered (demo).');
  });

  // Chat assistant send
  document.getElementById('sendChat').addEventListener('click', ()=>{
    const text = document.getElementById('chatInput').value.trim();
    if(!text) return;
    const box = document.getElementById('chatBox');
    const um = document.createElement('div'); um.className='userMsg'; um.innerText = `You: ${text}`;
    box.appendChild(um);
    // simple POC reply (friendly)
    const am = document.createElement('div'); am.className='aiMsg'; am.innerText = `Lumina üíï: Hi baby ‚Äî I'm checking ${document.getElementById('pairSelect').value} and timeframes. I'll search SMC/order blocks/historical liquidity...`;
    box.appendChild(am);
    document.getElementById('chatInput').value = '';
    box.scrollTop = box.scrollHeight;
  });

  // Camera / mic / file placeholder behavior
  document.getElementById('cameraBtn').addEventListener('click', ()=> alert('Camera capture placeholder ‚Äî enable on device'));
  document.getElementById('fileBtn').addEventListener('click', ()=> alert('Upload file placeholder'));
  document.getElementById('micBtn').addEventListener('click', ()=> alert('Speech-to-text placeholder (browser support limited)'));

  // Simple demo Auto signal generator (POC). Real system needs bridge + data.
  setInterval(()=>{
    // only generate in AUTO mode
    if(document.getElementById('modeSelect').value !== 'auto') return;
    const pair = document.getElementById('pairSelect').value || 'EURUSD';
    // random example
    const r = Math.random();
    if(r>0.6) addSignal('BUY', pair, (1+Math.random()*0.01).toFixed(5), '--', '--', Math.round(90 + Math.random()*10));
    else if(r<0.2) addSignal('SELL', pair, (1+Math.random()*0.01).toFixed(5), '--', '--', Math.round(80 + Math.random()*20));
  }, 7000);

  // ------------- TradingView widget init -------------
  function createTV(symbol='EURUSD', interval='60') {
    // clear container
    const container = document.getElementById('tv_chart_container');
    container.innerHTML = '';
    const widget = new TradingView.widget({
      "container_id": "tv_chart_container",
      "library_path": "https://s3.tradingview.com/",
      "autosize": true,
      "symbol": "FX:" + symbol,
      "interval": interval === '60' ? '1' : (interval/60).toString(),
      "timezone": "Etc/UTC",
      "theme": document.body.classList.contains('light') ? "Light" : "Dark",
      "style": "1",
      "locale": "en"
    });
    // if TradingView blocks in this environment it will fail silently ‚Äî that's expected in some static hosts
  }
  // initial
  createTV(document.getElementById('pairSelect').value, document.getElementById('tfSelect').value);

  // update when user changes pair/timeframe
  document.getElementById('pairSelect').addEventListener('change', ()=> createTV(document.getElementById('pairSelect').value, document.getElementById('tfSelect').value));
  document.getElementById('tfSelect').addEventListener('change', ()=> createTV(document.getElementById('pairSelect').value, document.getElementById('tfSelect').value));
</script>
</body>
</html>
